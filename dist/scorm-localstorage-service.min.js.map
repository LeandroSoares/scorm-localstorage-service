{"version":3,"sources":["consts.js","LocstorService.js","PersistanceFake.js","PersistanceService.js","ScormService.js"],"names":["QUIZES","STATUS","PASSED","COMPLETED","FAILED","INCOMPLETE","BROWSED","NOT_ATTEMPTED","SCORM_API","SUSPEND_DATA","LESSON_STATUS","LESSON_LOCATION","SCORE","LocstorService","_classCallCheck","this","name","key","localStorage","getItem","value","setItem","JSON","parse","get","set","stringify","console","log","PersistanceFake","db","concat","objects","getObject","setObject","quizes","loadObject","saveObject","setLessonStatus","status","PersistanceService","scorm","locstor","persistance","ready","ScormAPIService","init","save","quit","pipwerks","SCORM","suspend_data","response"],"mappings":"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","file":"scorm-localstorage-service.min.js","sourcesContent":["const QUIZES = \"quizes\";\r\nconst STATUS = {\r\n    PASSED: \"passed\",\r\n    COMPLETED: \"completed\",\r\n    FAILED: \"failed\",\r\n    INCOMPLETE: \"incomplete\",\r\n    BROWSED: \"browsed\",\r\n    NOT_ATTEMPTED: \"not attempted\"\r\n};\r\n\r\nconst SCORM_API = {\r\n    SUSPEND_DATA: \"cmi.suspend_data\",\r\n    LESSON_STATUS: \"cmi.core.lesson_status\",\r\n    LESSON_LOCATION: \"cmi.core.lesson_location\",\r\n    SCORE: \"cmi.core.score.raw\"\r\n};\r\n","class LocstorService {\r\n    constructor() {\r\n        this.name = 'localStorage';\r\n    }\r\n\r\n    init() {\r\n        return true;\r\n    }\r\n\r\n    get(key) {\r\n        return localStorage.getItem(key);\r\n    }\r\n\r\n    set(key, value) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    }\r\n    getObject(key) {\r\n        return JSON.parse(this.get(key));\r\n    }\r\n    setObject(key, value) {\r\n        this.set(key, JSON.stringify(value));\r\n        return true;\r\n    }\r\n    save() {\r\n        console.log('trying to save...');\r\n        return true;\r\n    }\r\n    quit() {\r\n        console.log('trying to quit...');\r\n    }\r\n}","class PersistanceFake {\r\n\tstatic Create() {\r\n\t\treturn new PersistanceFake();\r\n\t}\r\n\tconstructor() {\r\n\t\tthis.name = \"PersistanceFake\";\r\n\t\tthis.db = {};\r\n\t\tconsole.log(`%c* Persistance - ${this.name} * `, \"font-weight:bold; color:purple\");\r\n\t}\r\n\r\n\tinit() {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tget(key) {\r\n\t\treturn this.db[key];\r\n\t}\r\n\r\n\tset(key, value) {\r\n\t\tthis.db[key] = value;\r\n\t\tconsole.log(\"PersistanceFake >>\", key, value);\r\n\t}\r\n\r\n\tsave() {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tquit() {\r\n\t\tconsole.log(\"PersistanceFake >> quit\");\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetObject(key) {\r\n\t\treturn this.get(key);\r\n\t}\r\n\r\n\tsetObject(key, value) {\r\n\t\tthis.set(key, value);\r\n\t}\r\n\r\n\tsaveObject(key, value) {\r\n\t\tlet objects = this.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n\t\tobjects[key] = value;\r\n\t\tthis.setObject(SCORM_API.SUSPEND_DATA, objects);\r\n\t}\r\n\r\n\tloadObject(key) {\r\n\t\tlet objects = this.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n\t\treturn objects[key];\r\n\t}\r\n\r\n\tsaveQuiz(key, value) {\r\n\t\tlet quizes = this.loadObject(QUIZES) || {};\r\n\t\tquizes[key] = value;\r\n\t\tthis.saveObject(QUIZES, quizes);\r\n\t}\r\n\r\n\tloadQuiz(key) {\r\n\t\tlet quizes = this.loadObject(QUIZES) || {};\r\n\t\treturn quizes[key];\r\n\t}\r\n\r\n\tgetQuizCollection() {\r\n\t\treturn this.loadObject(QUIZES);\r\n\t}\r\n\r\n\tsetCompleted() {\r\n\t\tthis.setLessonStatus(STATUS.COMPLETED);\r\n\t}\r\n\r\n\tsetLessonStatus(status) {\r\n\t\tthis.set(SCORM_API.LESSON_STATUS, status);\r\n\t}\r\n}","class PersistanceService {\r\n    static Create() {\r\n        return new PersistanceService(new ScormAPIService(), new LocstorService());\r\n    }\r\n    constructor(scorm, locstor) {\r\n        this.scorm = scorm;\r\n        this.locstor = locstor;\r\n        this.persistance = this.scorm.ready ? this.scorm : this.locstor;\r\n        console.log(`%c* Persistance - ${this.persistance.name} * `, \"font-weight:bold; color:purple\");\r\n    }\r\n    // inicializa scorm\r\n    init() {\r\n        return this.persistance.init();\r\n    }\r\n    // retorna dados direto do scorm\r\n    get(key) {\r\n        return this.persistance.get(key);\r\n    }\r\n    // salva dados direto no scorm\r\n    set(key, value) {\r\n        return this.persistance.set(key, value);\r\n    }\r\n    // commit do scorm\r\n    save() {\r\n        return this.persistance.save();\r\n    }\r\n    //scorm quit\r\n    quit() {\r\n        this.persistance.quit();\r\n    }\r\n    // retorna dados do scorm passados pelo JSON.parse\r\n    getObject(key) {\r\n        return this.persistance.getObject(key);\r\n    }\r\n    // salva dados no scorm passados pelo JSON.stringify\r\n    setObject(key, value) {\r\n        return this.persistance.setObject(key, value);\r\n    }\r\n\r\n    saveObject(key, value) {\r\n        let objects = this.persistance.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n        objects[key] = value;\r\n        this.persistance.setObject(SCORM_API.SUSPEND_DATA, objects);\r\n    }\r\n\r\n    loadObject(key) {\r\n        let objects = this.persistance.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n        return objects[key];\r\n    }\r\n\r\n    saveQuiz(key, value) {\r\n        let quizes = this.loadObject(QUIZES) || {};\r\n        quizes[key] = value;\r\n        this.saveObject(QUIZES, quizes);\r\n    }\r\n\r\n    loadQuiz(key) {\r\n        let quizes = this.loadObject(QUIZES) || {};\r\n        return quizes[key];\r\n    }\r\n\r\n    getQuizCollection() {\r\n        return this.loadObject(QUIZES);\r\n    }\r\n\r\n    setCompleted() {\r\n        this.setLessonStatus(STATUS.COMPLETED);\r\n    }\r\n\r\n    setLessonStatus(status) {\r\n        this.set(SCORM_API.LESSON_STATUS, status);\r\n    }\r\n}","class ScormAPIService {\r\n    constructor() {\r\n        this.name = 'scorm';\r\n        this.scorm = pipwerks.SCORM;\r\n        this.ready = this.init();\r\n    }\r\n\r\n    saveData(key, value) {\r\n        this.suspend_data[key] = value;\r\n        this.set(SCORM_API.SUSPEND_DATA, JSON.stringify(this.suspend_data));\r\n    }\r\n\r\n    getData(key) {\r\n        return this.suspend_data[key];\r\n    }\r\n\r\n    init() {\r\n        return this.scorm.init();\r\n    }\r\n\r\n    get(key) {\r\n        return this.scorm.get(key);\r\n    }\r\n\r\n    set(key, value) {\r\n        let response = this.scorm.set(key, value);\r\n        this.scorm.save();\r\n        return response;\r\n    }\r\n\r\n    getObject(key) {\r\n        return JSON.parse(this.get(key) || \"{}\");\r\n    }\r\n\r\n    setObject(key, value) {\r\n        return this.set(key, JSON.stringify(value));\r\n    }\r\n    \r\n    save() {\r\n        return this.scorm.save();\r\n    }\r\n\r\n    quit() {\r\n        this.scorm.quit();\r\n    }\r\n}"]}