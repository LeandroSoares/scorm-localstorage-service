{"version":3,"sources":["consts.js","LocstorService.js","PersistanceFake.js","PersistanceService.js","ScormService.js"],"names":["QUIZES","STATUS","PASSED","COMPLETED","FAILED","INCOMPLETE","BROWSED","NOT_ATTEMPTED","SCORM_API","SUSPEND_DATA","LESSON_STATUS","LESSON_LOCATION","SCORE","LocstorService","_classCallCheck","this","name","key","localStorage","getItem","value","setItem","JSON","parse","get","set","stringify","console","log","PersistanceFake","db","concat","persistance","objects","getObject","setObject","quizes","loadObject","saveObject","setLessonStatus","status","PersistanceService","scorm","locstor","ready","ScormAPIService","init","save","quit","pipwerks","SCORM","suspend_data","response"],"mappings":"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","file":"scorm-localstorage-service.min.js","sourcesContent":["const QUIZES = \"quizes\";\r\nconst STATUS = {\r\n    PASSED: \"passed\",\r\n    COMPLETED: \"completed\",\r\n    FAILED: \"failed\",\r\n    INCOMPLETE: \"incomplete\",\r\n    BROWSED: \"browsed\",\r\n    NOT_ATTEMPTED: \"not attempted\"\r\n};\r\n\r\nconst SCORM_API = {\r\n    SUSPEND_DATA: \"cmi.suspend_data\",\r\n    LESSON_STATUS: \"cmi.core.lesson_status\",\r\n    LESSON_LOCATION: \"cmi.core.lesson_location\",\r\n    SCORE: \"cmi.core.score.raw\"\r\n};\r\n","class LocstorService {\r\n    constructor() {\r\n        this.name = 'localStorage';\r\n    }\r\n\r\n    init() {\r\n        return true;\r\n    }\r\n\r\n    get(key) {\r\n        return localStorage.getItem(key);\r\n    }\r\n\r\n    set(key, value) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    }\r\n    getObject(key) {\r\n        return JSON.parse(this.get(key));\r\n    }\r\n    setObject(key, value) {\r\n        this.set(key, JSON.stringify(value));\r\n        return true;\r\n    }\r\n    save() {\r\n        console.log('trying to save...');\r\n        return true;\r\n    }\r\n    quit() {\r\n        console.log('trying to quit...');\r\n    }\r\n}","class PersistanceFake {\r\n    constructor() {\r\n        this.name = \"PersistanceFake\";\r\n        this.db = {};\r\n        console.log(`%c* Persistance - ${this.persistance.name} * `, \"font-weight:bold; color:purple\");\r\n    }\r\n\r\n    init() {\r\n        return true;\r\n    }\r\n\r\n    get(key) {\r\n        return this.db[key];\r\n    }\r\n\r\n    set(key, value) {\r\n        this.db[key] = value;\r\n        console.log(\"PersistanceFake >>\", key, value);\r\n    }\r\n\r\n    save() {\r\n        return true;\r\n    }\r\n\r\n    quit() {\r\n        console.log(\"PersistanceFake >> quit\");\r\n        return true;\r\n    }\r\n\r\n    getObject(key) {\r\n        return this.get(key);\r\n    }\r\n\r\n    setObject(key, value) {\r\n        this.set(key, value);\r\n    }\r\n\r\n    saveObject(key, value) {\r\n        let objects = this.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n        objects[key] = value;\r\n        this.setObject(SCORM_API.SUSPEND_DATA, objects);\r\n    }\r\n\r\n    loadObject(key) {\r\n        let objects = this.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n        return objects[key];\r\n    }\r\n\r\n    saveQuiz(key, value) {\r\n        let quizes = this.loadObject(QUIZES) || {};\r\n        quizes[key] = value;\r\n        this.saveObject(QUIZES, quizes);\r\n    }\r\n\r\n    loadQuiz(key) {\r\n        let quizes = this.loadObject(QUIZES) || {};\r\n        return quizes[key];\r\n    }\r\n\r\n    getQuizCollection() {\r\n        return this.loadObject(QUIZES);\r\n    }\r\n\r\n    setCompleted() {\r\n        this.setLessonStatus(STATUS.COMPLETED);\r\n    }\r\n\r\n    setLessonStatus(status) {\r\n        this.set(SCORM_API.LESSON_STATUS, status);\r\n    }\r\n}","class PersistanceService {\r\n    static Create() {\r\n        return new PersistanceService(new ScormAPIService(), new LocstorService());\r\n    }\r\n    constructor(scorm, locstor) {\r\n        this.scorm = scorm;\r\n        this.locstor = locstor;\r\n        this.persistance = this.scorm.ready ? this.scorm : this.locstor;\r\n        console.log(`%c* Persistance - ${this.persistance.name} * `, \"font-weight:bold; color:purple\");\r\n    }\r\n    // inicializa scorm\r\n    init() {\r\n        return this.persistance.init();\r\n    }\r\n    // retorna dados direto do scorm\r\n    get(key) {\r\n        return this.persistance.get(key);\r\n    }\r\n    // salva dados direto no scorm\r\n    set(key, value) {\r\n        return this.persistance.set(key, value);\r\n    }\r\n    // commit do scorm\r\n    save() {\r\n        return this.persistance.save();\r\n    }\r\n    //scorm quit\r\n    quit() {\r\n        this.persistance.quit();\r\n    }\r\n    // retorna dados do scorm passados pelo JSON.parse\r\n    getObject(key) {\r\n        return this.persistance.getObject(key);\r\n    }\r\n    // salva dados no scorm passados pelo JSON.stringify\r\n    setObject(key, value) {\r\n        return this.persistance.setObject(key, value);\r\n    }\r\n\r\n    saveObject(key, value) {\r\n        let objects = this.persistance.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n        objects[key] = value;\r\n        this.persistance.setObject(SCORM_API.SUSPEND_DATA, objects);\r\n    }\r\n\r\n    loadObject(key) {\r\n        let objects = this.persistance.getObject(SCORM_API.SUSPEND_DATA) || {};\r\n        return objects[key];\r\n    }\r\n\r\n    saveQuiz(key, value) {\r\n        let quizes = this.loadObject(QUIZES) || {};\r\n        quizes[key] = value;\r\n        this.saveObject(QUIZES, quizes);\r\n    }\r\n\r\n    loadQuiz(key) {\r\n        let quizes = this.loadObject(QUIZES) || {};\r\n        return quizes[key];\r\n    }\r\n\r\n    getQuizCollection() {\r\n        return this.loadObject(QUIZES);\r\n    }\r\n\r\n    setCompleted() {\r\n        this.setLessonStatus(STATUS.COMPLETED);\r\n    }\r\n\r\n    setLessonStatus(status) {\r\n        this.set(SCORM_API.LESSON_STATUS, status);\r\n    }\r\n}","class ScormAPIService {\r\n    constructor() {\r\n        this.name = 'scorm';\r\n        this.scorm = pipwerks.SCORM;\r\n        this.ready = this.init();\r\n    }\r\n\r\n    saveData(key, value) {\r\n        this.suspend_data[key] = value;\r\n        this.set(SCORM_API.SUSPEND_DATA, JSON.stringify(this.suspend_data));\r\n    }\r\n\r\n    getData(key) {\r\n        return this.suspend_data[key];\r\n    }\r\n\r\n    init() {\r\n        return this.scorm.init();\r\n    }\r\n\r\n    get(key) {\r\n        return this.scorm.get(key);\r\n    }\r\n\r\n    set(key, value) {\r\n        let response = this.scorm.set(key, value);\r\n        this.scorm.save();\r\n        return response;\r\n    }\r\n\r\n    getObject(key) {\r\n        return JSON.parse(this.get(key) || \"{}\");\r\n    }\r\n\r\n    setObject(key, value) {\r\n        return this.set(key, JSON.stringify(value));\r\n    }\r\n    \r\n    save() {\r\n        return this.scorm.save();\r\n    }\r\n\r\n    quit() {\r\n        this.scorm.quit();\r\n    }\r\n}"]}